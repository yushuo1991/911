# ğŸš€ éƒ¨ç½²å’Œæ›´æ–°æŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•éƒ¨ç½²é¡¹ç›®ä»¥åŠå¦‚ä½•è¿›è¡Œæ—¥å¸¸æ›´æ–°ã€‚

## ğŸ“‹ ç›®å½•

- [è‡ªåŠ¨åŒ–éƒ¨ç½²ç³»ç»Ÿ](#è‡ªåŠ¨åŒ–éƒ¨ç½²ç³»ç»Ÿ)
- [æ—¥å¸¸æ›´æ–°æ–¹æ³•](#æ—¥å¸¸æ›´æ–°æ–¹æ³•)
- [éƒ¨ç½²çŠ¶æ€ç›‘æ§](#éƒ¨ç½²çŠ¶æ€ç›‘æ§)
- [é«˜çº§æ“ä½œ](#é«˜çº§æ“ä½œ)
- [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)

---

## ğŸ¯ è‡ªåŠ¨åŒ–éƒ¨ç½²ç³»ç»Ÿ

æœ¬é¡¹ç›®å·²é…ç½®å®Œæ•´çš„ CI/CD è‡ªåŠ¨åŒ–éƒ¨ç½²ç³»ç»Ÿï¼š

### å·¥ä½œæµç¨‹

```
æœ¬åœ°ä¿®æ”¹ä»£ç  â†’ git push â†’ GitHub Actions â†’ è‡ªåŠ¨æ„å»º â†’ è‡ªåŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨ â†’ è‡ªåŠ¨é‡å¯æœåŠ¡
```

### éƒ¨ç½²é…ç½®

**GitHub ä»“åº“ï¼š** https://github.com/yushuo1991/stock-tracker

**æœåŠ¡å™¨ä¿¡æ¯ï¼š**
- IP: 107.173.154.147
- ç”¨æˆ·: root
- ç«¯å£: 22
- é¡¹ç›®ç›®å½•: `/www/wwwroot/stock-tracker` æˆ– `~/stock-tracker`

**GitHub Actionsï¼š**
- é…ç½®æ–‡ä»¶: `.github/workflows/deploy.yml`
- è§¦å‘æ¡ä»¶: æ¨é€åˆ° `main` åˆ†æ”¯
- éƒ¨ç½²æ—¶é—´: çº¦ 3-5 åˆ†é’Ÿ

---

## ğŸ”„ æ—¥å¸¸æ›´æ–°æ–¹æ³•

### æ–¹æ³• 1ï¼šGit å‘½ä»¤è¡Œï¼ˆæ¨èï¼‰â­

è¿™æ˜¯æœ€ç®€å•ã€æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼š

```bash
# 1. æŸ¥çœ‹ä¿®æ”¹çš„æ–‡ä»¶
git status

# 2. æ·»åŠ æ‰€æœ‰ä¿®æ”¹
git add .

# 3. æäº¤ä¿®æ”¹ï¼ˆå¡«å†™è¯´æ˜ï¼‰
git commit -m "ä½ çš„ä¿®æ”¹è¯´æ˜"

# 4. æ¨é€åˆ° GitHubï¼ˆè§¦å‘è‡ªåŠ¨éƒ¨ç½²ï¼‰
git push
```

**ä¸€é”®å®Œæˆï¼š**
```bash
git add . && git commit -m "update" && git push
```

**æ¨é€åä¼šè‡ªåŠ¨ï¼š**
1. âœ… è§¦å‘ GitHub Actions
2. âœ… å®‰è£…ä¾èµ– (`npm ci`)
3. âœ… æ„å»ºé¡¹ç›® (`npm run build`)
4. âœ… é€šè¿‡ SSH éƒ¨ç½²åˆ°æœåŠ¡å™¨
5. âœ… åœ¨æœåŠ¡å™¨ä¸Šæ‹‰å–æœ€æ–°ä»£ç 
6. âœ… é‡æ–°æ„å»ºå¹¶é‡å¯ PM2 æœåŠ¡

**ç­‰å¾… 3-5 åˆ†é’Ÿï¼Œä½ çš„æ›´æ–°å°±ä¼šç”Ÿæ•ˆï¼**

---

### æ–¹æ³• 2ï¼šGitHub ç½‘é¡µç¼–è¾‘

é€‚åˆå°ä¿®æ”¹ï¼ˆå¦‚æ›´æ–°æ–‡æ¡£ã€ä¿®æ”¹é…ç½®ï¼‰ï¼š

1. è®¿é—® https://github.com/yushuo1991/stock-tracker
2. æ‰¾åˆ°è¦ä¿®æ”¹çš„æ–‡ä»¶
3. ç‚¹å‡»å³ä¸Šè§’çš„ âœï¸ ç¼–è¾‘æŒ‰é’®
4. ä¿®æ”¹å†…å®¹
5. é¡µé¢åº•éƒ¨å¡«å†™æäº¤è¯´æ˜
6. ç‚¹å‡» **"Commit changes"**
7. è‡ªåŠ¨éƒ¨ç½²ï¼

---

### æ–¹æ³• 3ï¼šä½¿ç”¨ä¸€é”®éƒ¨ç½²è„šæœ¬

é¡¹ç›®æ ¹ç›®å½•æä¾›äº†ä¸€é”®éƒ¨ç½²è„šæœ¬ï¼š

**Windowsï¼š**
åŒå‡»è¿è¡Œ `GitHub-CLIè‡ªåŠ¨åŒ–.bat`

**æˆ–å‘½ä»¤è¡Œï¼š**
```powershell
powershell -ExecutionPolicy Bypass -File auto-deploy-github.ps1
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- æ£€æŸ¥ Git çŠ¶æ€
- æäº¤æ‰€æœ‰ä¿®æ”¹
- æ¨é€åˆ° GitHub
- è§¦å‘è‡ªåŠ¨éƒ¨ç½²

---

## ğŸ“Š éƒ¨ç½²çŠ¶æ€ç›‘æ§

### åœ¨çº¿æŸ¥çœ‹ï¼ˆæ¨èï¼‰

è®¿é—® GitHub Actions é¡µé¢ï¼š
```
https://github.com/yushuo1991/stock-tracker/actions
```

ä½ ä¼šçœ‹åˆ°ï¼š
- âœ… **ç»¿è‰²å‹¾**ï¼šéƒ¨ç½²æˆåŠŸ
- âŒ **çº¢è‰²å‰**ï¼šéƒ¨ç½²å¤±è´¥
- ğŸŸ¡ **é»„è‰²åœ†**ï¼šéƒ¨ç½²è¿›è¡Œä¸­

ç‚¹å‡»ä»»æ„éƒ¨ç½²è®°å½•å¯æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ã€‚

---

### å‘½ä»¤è¡ŒæŸ¥çœ‹

**æŸ¥çœ‹æœ€è¿‘çš„éƒ¨ç½²è®°å½•ï¼š**
```bash
gh run list --repo yushuo1991/stock-tracker --limit 10
```

**å®æ—¶ç›‘æ§å½“å‰éƒ¨ç½²ï¼š**
```bash
gh run watch --repo yushuo1991/stock-tracker
```

**æŸ¥çœ‹å¤±è´¥çš„éƒ¨ç½²æ—¥å¿—ï¼š**
```bash
gh run view --repo yushuo1991/stock-tracker --log-failed
```

---

## ğŸ› ï¸ é«˜çº§æ“ä½œ

### æ‰‹åŠ¨è§¦å‘éƒ¨ç½²

å³ä½¿æ²¡æœ‰ä»£ç ä¿®æ”¹ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨è§¦å‘éƒ¨ç½²ï¼š

**æ–¹æ³• 1ï¼šGitHub ç½‘é¡µ**
1. è®¿é—® https://github.com/yushuo1991/stock-tracker/actions
2. é€‰æ‹© "Auto Deploy to Server"
3. ç‚¹å‡» "Run workflow"
4. é€‰æ‹©åˆ†æ”¯ï¼ˆmainï¼‰
5. ç‚¹å‡» "Run workflow"

**æ–¹æ³• 2ï¼šå‘½ä»¤è¡Œ**
```bash
gh workflow run deploy.yml --repo yushuo1991/stock-tracker
```

---

### å›æ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬

å¦‚æœæ–°ç‰ˆæœ¬æœ‰é—®é¢˜ï¼Œå¯ä»¥å›æ»šï¼š

```bash
# 1. æŸ¥çœ‹æäº¤å†å²
git log --oneline

# 2. å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬ï¼ˆæ›¿æ¢ <commit-hash>ï¼‰
git reset --hard <commit-hash>

# 3. å¼ºåˆ¶æ¨é€ï¼ˆä¼šè§¦å‘é‡æ–°éƒ¨ç½²ï¼‰
git push --force
```

**âš ï¸ æ³¨æ„ï¼š** å¼ºåˆ¶æ¨é€ä¼šè¦†ç›–è¿œç¨‹å†å²ï¼Œè¯·è°¨æ…ä½¿ç”¨ï¼

---

### ä¿®æ”¹éƒ¨ç½²é…ç½®

å¦‚æœéœ€è¦ä¿®æ”¹æœåŠ¡å™¨ä¿¡æ¯ã€éƒ¨ç½²æµç¨‹ç­‰ï¼š

**1. ä¿®æ”¹æœåŠ¡å™¨ä¿¡æ¯ï¼ˆGitHub Secretsï¼‰ï¼š**

è®¿é—®ï¼š`https://github.com/yushuo1991/stock-tracker/settings/secrets/actions`

å¯ä¿®æ”¹çš„ Secretsï¼š
- `SERVER_HOST` - æœåŠ¡å™¨ IP
- `SERVER_USER` - SSH ç”¨æˆ·å
- `SERVER_PASSWORD` - SSH å¯†ç 
- `SERVER_PORT` - SSH ç«¯å£

**2. ä¿®æ”¹éƒ¨ç½²æµç¨‹ï¼š**

ç¼–è¾‘æ–‡ä»¶ï¼š`.github/workflows/deploy.yml`

```yaml
# ä¾‹å¦‚ï¼šä¿®æ”¹ Node.js ç‰ˆæœ¬
- name: Setup Node.js
  uses: actions/setup-node@v4
  with:
    node-version: '20'  # ä» 18 æ”¹ä¸º 20
```

ä¿®æ”¹åæäº¤å¹¶æ¨é€å³å¯ç”Ÿæ•ˆã€‚

---

### æœåŠ¡å™¨ç«¯æ“ä½œ

æœ‰æ—¶éœ€è¦ç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šæ“ä½œï¼š

**è¿æ¥åˆ°æœåŠ¡å™¨ï¼š**
```bash
ssh root@107.173.154.147
```

**è¿›å…¥é¡¹ç›®ç›®å½•ï¼š**
```bash
cd /www/wwwroot/stock-tracker
# æˆ–
cd ~/stock-tracker
```

**æ‰‹åŠ¨é‡å¯æœåŠ¡ï¼š**
```bash
pm2 restart stock-tracker
```

**æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š**
```bash
pm2 status
pm2 logs stock-tracker
```

**æ‰‹åŠ¨æ‹‰å–æœ€æ–°ä»£ç ï¼š**
```bash
git pull origin main
npm install
npm run build
pm2 restart stock-tracker
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### éƒ¨ç½²å¤±è´¥å¸¸è§é—®é¢˜

#### 1. æ„å»ºå¤±è´¥ï¼ˆBuild project âŒï¼‰

**ç—‡çŠ¶ï¼š** åœ¨ "Build project" æ­¥éª¤å¤±è´¥

**å¯èƒ½åŸå› ï¼š**
- ä»£ç è¯­æ³•é”™è¯¯
- TypeScript ç±»å‹é”™è¯¯
- ä¾èµ–ç‰ˆæœ¬å†²çª

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æœ¬åœ°å…ˆæµ‹è¯•æ„å»º
npm run build

# å¦‚æœæœ¬åœ°æ„å»ºå¤±è´¥ï¼Œä¿®å¤é”™è¯¯åå†æ¨é€
```

---

#### 2. SSH è¿æ¥å¤±è´¥ï¼ˆDeploy to Server via SSH âŒï¼‰

**ç—‡çŠ¶ï¼š** åœ¨ "Deploy to Server via SSH" æ­¥éª¤å¤±è´¥

**å¯èƒ½åŸå› ï¼š**
- æœåŠ¡å™¨å¯†ç é”™è¯¯
- æœåŠ¡å™¨ IP å˜æ›´
- æœåŠ¡å™¨ SSH æœåŠ¡æœªå¯åŠ¨

**è§£å†³æ–¹æ³•ï¼š**
1. æ£€æŸ¥ GitHub Secrets ä¸­çš„æœåŠ¡å™¨ä¿¡æ¯æ˜¯å¦æ­£ç¡®
2. æ‰‹åŠ¨æµ‹è¯• SSH è¿æ¥ï¼š
   ```bash
   ssh root@107.173.154.147
   ```
3. å¦‚æœæ— æ³•è¿æ¥ï¼Œè”ç³»æœåŠ¡å™¨ç®¡ç†å‘˜

---

#### 3. æœåŠ¡å™¨ä¸Šæ„å»ºå¤±è´¥

**ç—‡çŠ¶ï¼š** SSH è¿æ¥æˆåŠŸï¼Œä½†æœåŠ¡å™¨ä¸Šæ‰§è¡Œå‘½ä»¤å¤±è´¥

**å¯èƒ½åŸå› ï¼š**
- æœåŠ¡å™¨ç£ç›˜ç©ºé—´ä¸è¶³
- Node.js ç‰ˆæœ¬ä¸å…¼å®¹
- PM2 æœªå®‰è£…æˆ–é…ç½®é”™è¯¯

**è§£å†³æ–¹æ³•ï¼š**
```bash
# è¿æ¥åˆ°æœåŠ¡å™¨
ssh root@107.173.154.147

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# æ£€æŸ¥ Node.js ç‰ˆæœ¬
node -v  # åº”è¯¥æ˜¯ v18 æˆ–æ›´é«˜

# æ£€æŸ¥ PM2
pm2 -v

# æ‰‹åŠ¨è¿è¡Œéƒ¨ç½²è„šæœ¬
cd /www/wwwroot/stock-tracker
git pull
npm install
npm run build
pm2 restart stock-tracker
```

---

#### 4. éƒ¨ç½²æˆåŠŸä½†ç½‘ç«™æ— æ³•è®¿é—®

**å¯èƒ½åŸå› ï¼š**
- PM2 æœåŠ¡æœªå¯åŠ¨
- ç«¯å£è¢«å ç”¨
- é˜²ç«å¢™é˜»æ­¢è®¿é—®

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æ£€æŸ¥ PM2 çŠ¶æ€
pm2 status

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
pm2 logs stock-tracker --lines 100

# é‡å¯åº”ç”¨
pm2 restart stock-tracker

# æŸ¥çœ‹ç«¯å£å ç”¨
netstat -tuln | grep 3000
```

---

### è·å–å¸®åŠ©

å¦‚æœé—®é¢˜ä¾ç„¶æ— æ³•è§£å†³ï¼š

1. **æŸ¥çœ‹å®Œæ•´æ—¥å¿—ï¼š**
   - è®¿é—® https://github.com/yushuo1991/stock-tracker/actions
   - ç‚¹å‡»å¤±è´¥çš„éƒ¨ç½²è®°å½•
   - æŸ¥çœ‹æ¯ä¸€æ­¥çš„è¯¦ç»†è¾“å‡º

2. **æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—ï¼š**
   ```bash
   ssh root@107.173.154.147
   pm2 logs stock-tracker --lines 200
   ```

3. **åˆ›å»º Issueï¼š**
   - è®¿é—® https://github.com/yushuo1991/stock-tracker/issues
   - ç‚¹å‡» "New issue"
   - æè¿°é—®é¢˜å¹¶é™„ä¸Šé”™è¯¯æ—¥å¿—

---

## ğŸ“ éƒ¨ç½²æ£€æŸ¥æ¸…å•

åœ¨æ¨é€é‡è¦æ›´æ–°ä¹‹å‰ï¼Œå»ºè®®æ£€æŸ¥ï¼š

- [ ] æœ¬åœ°è¿è¡Œ `npm run build` æˆåŠŸ
- [ ] æœ¬åœ°è¿è¡Œ `npm start` å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] å·²æµ‹è¯•æ–°åŠŸèƒ½
- [ ] å·²æ›´æ–°ç›¸å…³æ–‡æ¡£
- [ ] commit message æ¸…æ™°æ˜äº†
- [ ] ç¡®è®¤è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

---

## ğŸ¯ æœ€ä½³å®è·µ

### æäº¤ä¿¡æ¯è§„èŒƒ

ä½¿ç”¨æ¸…æ™°çš„ commit messageï¼š

```bash
# åŠŸèƒ½å¼€å‘
git commit -m "feat: æ·»åŠ è‚¡ç¥¨æœç´¢åŠŸèƒ½"

# Bug ä¿®å¤
git commit -m "fix: ä¿®å¤äº¤æ˜“æ—¥å†æ—¶åŒºé—®é¢˜"

# æ–‡æ¡£æ›´æ–°
git commit -m "docs: æ›´æ–°éƒ¨ç½²æ–‡æ¡£"

# æ ·å¼è°ƒæ•´
git commit -m "style: ä¼˜åŒ–ç§»åŠ¨ç«¯å¸ƒå±€"

# æ€§èƒ½ä¼˜åŒ–
git commit -m "perf: ä¼˜åŒ–æ•°æ®åŠ è½½é€Ÿåº¦"

# ä»£ç é‡æ„
git commit -m "refactor: é‡æ„è‚¡ç¥¨æ•°æ®å¤„ç†é€»è¾‘"
```

### åˆ†æ”¯ç®¡ç†

```bash
# å¼€å‘æ–°åŠŸèƒ½æ—¶åˆ›å»ºåˆ†æ”¯
git checkout -b feature/new-chart

# å®Œæˆååˆå¹¶åˆ° main
git checkout main
git merge feature/new-chart
git push
```

### å®šæœŸå¤‡ä»½

```bash
# åœ¨æœåŠ¡å™¨ä¸Šå®šæœŸå¤‡ä»½æ•°æ®
ssh root@107.173.154.147
cd /www/wwwroot/stock-tracker
tar -czf backup_$(date +%Y%m%d).tar.gz .
```

---

## ğŸ“ è”ç³»æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿ
- ğŸ“§ Email: your-email@example.com
- ğŸ’¬ GitHub Issues: https://github.com/yushuo1991/stock-tracker/issues
- ğŸ“– æ›´å¤šæ–‡æ¡£: [README.md](../README.md)

---

**âš¡ è®°ä½ï¼šæ›´æ–°ä»£ç åªéœ€ä¸‰æ­¥ï¼**
```bash
git add .
git commit -m "update"
git push
```

