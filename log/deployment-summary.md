# è‚¡ç¥¨è¿½è¸ªç³»ç»Ÿv4.2 - å®å¡”é¢æ¿éƒ¨ç½²æ€»ç»“

## ğŸ¯ éƒ¨ç½²æ–¹æ¡ˆå®Œæˆ

å·²ä¸ºæ‚¨åˆ›å»ºäº†å®Œæ•´çš„å®å¡”é¢æ¿éƒ¨ç½²è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

### ğŸ“‹ æ ¸å¿ƒæ–‡ä»¶

1. **baota-deploy.sh** - ä¸€é”®è‡ªåŠ¨éƒ¨ç½²è„šæœ¬
2. **server-env-check.sh** - æœåŠ¡å™¨ç¯å¢ƒæ£€æµ‹è„šæœ¬
3. **log/baota-deployment-guide.md** - è¯¦ç»†éƒ¨ç½²æŒ‡å—æ–‡æ¡£

## ğŸš€ éƒ¨ç½²æ­¥éª¤ï¼ˆæ¨èï¼‰

### å¿«é€Ÿéƒ¨ç½²ï¼ˆè‡ªåŠ¨åŒ–ï¼‰
```bash
# 1. è¿æ¥åˆ°æ‚¨çš„æœåŠ¡å™¨
ssh root@your-server-ip

# 2. ä¸‹è½½éƒ¨ç½²è„šæœ¬
wget https://raw.githubusercontent.com/shishen168/stock-tracker/main/baota-deploy.sh
chmod +x baota-deploy.sh

# 3. æ‰§è¡Œéƒ¨ç½²
sudo ./baota-deploy.sh
```

### éƒ¨ç½²å‰ç¯å¢ƒæ£€æµ‹ï¼ˆå»ºè®®ï¼‰
```bash
# å…ˆè¿è¡Œç¯å¢ƒæ£€æµ‹è„šæœ¬
wget https://raw.githubusercontent.com/shishen168/stock-tracker/main/server-env-check.sh
chmod +x server-env-check.sh
./server-env-check.sh
```

## ğŸ“Š ç³»ç»Ÿæ¶æ„è§£æ

### æ ¸å¿ƒæ¨¡å—è¯´æ˜

1. **Next.jsåº”ç”¨æ¨¡å—**
   - åŠŸèƒ½: å‰ç«¯ç•Œé¢å’ŒAPIæ¥å£
   - ç«¯å£: 3002
   - è¿›ç¨‹ç®¡ç†: PM2

2. **Nginxåå‘ä»£ç†æ¨¡å—**
   - åŠŸèƒ½: è¯·æ±‚è½¬å‘å’Œé™æ€èµ„æºæœåŠ¡
   - é…ç½®: æ”¯æŒå­è·¯å¾„ `/cc` è®¿é—®
   - SSL: æ”¯æŒHTTPSè¯ä¹¦é…ç½®

3. **SQLiteæ•°æ®åº“æ¨¡å—**
   - åŠŸèƒ½: æœ¬åœ°æ•°æ®å­˜å‚¨
   - ä½ç½®: `./data/stock_tracker.db`
   - ä¼˜åŠ¿: è½»é‡çº§ï¼Œæ— éœ€é¢å¤–æ•°æ®åº“æœåŠ¡

4. **å®šæ—¶ä»»åŠ¡æ¨¡å—**
   - åŠŸèƒ½: è‚¡ç¥¨æ•°æ®è‡ªåŠ¨æ›´æ–°
   - API: `/api/cron`, `/api/scheduler`
   - æ•°æ®æº: Tushare API

## ğŸ”§ å…³é”®æŠ€æœ¯ç‚¹

### å½±å“åˆ†æ
- **Nginxæ¨¡å—**: å¤„ç†HTTPè¯·æ±‚è·¯ç”±ï¼Œå½±å“è®¿é—®é€Ÿåº¦å’Œç¨³å®šæ€§
- **PM2æ¨¡å—**: è¿›ç¨‹å®ˆæŠ¤å’Œç›‘æ§ï¼Œå½±å“åº”ç”¨å¯é æ€§
- **æ•°æ®åº“æ¨¡å—**: SQLiteæœ¬åœ°å­˜å‚¨ï¼Œå½±å“æ•°æ®æŸ¥è¯¢æ€§èƒ½
- **APIæ¨¡å—**: Tushareæ•°æ®æ¥å£ï¼Œå½±å“è‚¡ç¥¨æ•°æ®æ›´æ–°

### è§£å†³çš„é—®é¢˜
1. **å­è·¯å¾„éƒ¨ç½²**: é…ç½®Nginxæ”¯æŒå­åŸŸåè®¿é—®
2. **è¿›ç¨‹ç®¡ç†**: PM2ç¡®ä¿åº”ç”¨è‡ªåŠ¨é‡å¯å’Œç›‘æ§
3. **é™æ€èµ„æº**: ä¼˜åŒ–Next.jsé™æ€æ–‡ä»¶ç¼“å­˜ç­–ç•¥
4. **SSLæ”¯æŒ**: è‡ªåŠ¨é€‚é…HTTPSè¯ä¹¦é…ç½®

## ğŸ“ éƒ¨ç½²åçš„ç›®å½•ç»“æ„
```
/www/wwwroot/stock-tracker/
â”œâ”€â”€ .next/                 # Next.jsæ„å»ºè¾“å‡º
â”œâ”€â”€ src/                   # æºä»£ç 
â”œâ”€â”€ data/                  # SQLiteæ•°æ®åº“
â”œâ”€â”€ log/                   # åº”ç”¨æ—¥å¿—
â”œâ”€â”€ .env.local            # ç¯å¢ƒé…ç½®
â”œâ”€â”€ package.json          # é¡¹ç›®é…ç½®
â”œâ”€â”€ ecosystem.config.js   # PM2é…ç½®
â””â”€â”€ node_modules/         # ä¾èµ–åŒ…
```

## ğŸ›ï¸ å®å¡”é¢æ¿æ“ä½œ

### 1. ç½‘ç«™ç®¡ç†
- æ·»åŠ ç«™ç‚¹: `yushuo.click`
- é…ç½®SSLè¯ä¹¦ï¼ˆæ¨èï¼‰
- è®¾ç½®åŸŸåè§£æ

### 2. è½¯ä»¶ç®¡ç†
- å®‰è£…Node.js 18+
- å®‰è£…PM2ç®¡ç†å™¨ï¼ˆå¯é€‰ï¼‰
- ç¡®ä¿Nginxè¿è¡Œæ­£å¸¸

### 3. æ–‡ä»¶ç®¡ç†
- é¡¹ç›®ç›®å½•: `/www/wwwroot/stock-tracker`
- å¯é€šè¿‡é¢æ¿ç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶
- æ”¯æŒåœ¨çº¿æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶

## ğŸ” ç›‘æ§ä¸ç»´æŠ¤

### åº”ç”¨ç›‘æ§å‘½ä»¤
```bash
# æŸ¥çœ‹PM2è¿›ç¨‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
pm2 logs stock-tracker-v42

# é‡å¯åº”ç”¨
pm2 restart stock-tracker-v42

# æŸ¥çœ‹ç³»ç»Ÿèµ„æº
pm2 monit
```

### æ•…éšœæ’é™¤
1. **åº”ç”¨æ— æ³•å¯åŠ¨**: æ£€æŸ¥PM2æ—¥å¿—å’Œç¯å¢ƒå˜é‡
2. **é¡µé¢404é”™è¯¯**: æ£€æŸ¥Nginxé…ç½®å’ŒåŸŸåè§£æ
3. **æ•°æ®è·å–å¤±è´¥**: éªŒè¯Tushare API Tokenæœ‰æ•ˆæ€§
4. **æ€§èƒ½é—®é¢˜**: ç›‘æ§æœåŠ¡å™¨èµ„æºä½¿ç”¨æƒ…å†µ

## ğŸ”„ æ›´æ–°æµç¨‹

```bash
cd /www/wwwroot/stock-tracker
git pull origin main
npm install
npm run build
pm2 restart stock-tracker-v42
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **è®¿é—®åœ°å€**: https://stock-tracker.yushuo.click
- **é¡¹ç›®ä»“åº“**: https://github.com/shishen168/stock-tracker
- **éƒ¨ç½²æ—¥å¿—**: ä¿å­˜åœ¨ `log/` ç›®å½•ä¸‹
- **é—®é¢˜åé¦ˆ**: GitHub Issues

---

**ğŸ‰ éƒ¨ç½²æ–¹æ¡ˆå·²å‡†å¤‡å°±ç»ªï¼Œè¯·æŒ‰ç…§ä¸Šè¿°æ­¥éª¤åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œéƒ¨ç½²ï¼**