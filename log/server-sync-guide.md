# æœåŠ¡å™¨ä»£ç åŒæ­¥æŒ‡å¯¼æ–‡æ¡£

## ğŸ“‹ åŒæ­¥æ“ä½œæ¦‚è§ˆ

å·²å°†v4.3ç‰ˆæœ¬æˆåŠŸæ¨é€åˆ°GitHubï¼Œç°åœ¨æ‚¨å¯ä»¥é€šè¿‡åŒæ­¥è„šæœ¬å°†ä»£ç æ›´æ–°åˆ°æœåŠ¡å™¨ã€‚

### GitHubæ¨é€çŠ¶æ€
- âœ… ä»£ç å·²æ¨é€: `main` åˆ†æ”¯ (commit: 3031ff7)
- âœ… æ ‡ç­¾å·²æ¨é€: `v4.3` æ ‡ç­¾
- ğŸ“ ä»“åº“åœ°å€: https://github.com/yushuo1991/911.git

---

## ğŸš€ æœåŠ¡å™¨åŒæ­¥æ­¥éª¤

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨åŒæ­¥è„šæœ¬ï¼ˆæ¨èï¼‰

#### 1. ä¸‹è½½åŒæ­¥è„šæœ¬
```bash
# è¿æ¥åˆ°æ‚¨çš„æœåŠ¡å™¨
ssh root@your-server-ip

# ä¸‹è½½åŒæ­¥è„šæœ¬
wget https://raw.githubusercontent.com/yushuo1991/911/main/server-sync.sh
chmod +x server-sync.sh
```

#### 2. æ‰§è¡ŒåŒæ­¥
```bash
# è¿è¡ŒåŒæ­¥è„šæœ¬
sudo ./server-sync.sh
```

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨åŒæ­¥

#### 1. è¿›å…¥é¡¹ç›®ç›®å½•
```bash
cd /www/wwwroot/stock-tracker
```

#### 2. æ‹‰å–æœ€æ–°ä»£ç 
```bash
# å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡éƒ¨ç½²
git clone https://github.com/yushuo1991/911.git .

# å¦‚æœå·²å­˜åœ¨é¡¹ç›®
git fetch origin
git checkout v4.3
git reset --hard v4.3
```

#### 3. æ›´æ–°åº”ç”¨
```bash
# å¦‚æœéœ€è¦é‡æ–°éƒ¨ç½²
npm install
npm run build
pm2 restart stock-tracker-v42
```

---

## ğŸ”§ æŠ€æœ¯æ¨¡å—è¯´æ˜

### 1. GitåŒæ­¥æ¨¡å—
- **åŠŸèƒ½**: ä»GitHubä»“åº“åŒæ­¥æœ€æ–°ä»£ç 
- **å½±å“**: ç¡®ä¿æœåŠ¡å™¨ä»£ç ä¸ä»“åº“ç‰ˆæœ¬ä¸€è‡´
- **å¤„ç†**: è‡ªåŠ¨å¤‡ä»½ç°æœ‰ä»£ç ï¼Œæ”¯æŒç‰ˆæœ¬å›æ»š

### 2. ç‰ˆæœ¬ç®¡ç†æ¨¡å—
- **åŠŸèƒ½**: åˆ‡æ¢åˆ°æŒ‡å®šç‰ˆæœ¬æ ‡ç­¾ (v4.3)
- **å½±å“**: ç¡®ä¿éƒ¨ç½²ç‰¹å®šç‰ˆæœ¬ï¼Œé¿å…ä¸ç¨³å®šä»£ç 
- **ç‰¹æ€§**: æ”¯æŒæ ‡ç­¾ä¼˜å…ˆï¼Œé™çº§åˆ°mainåˆ†æ”¯

### 3. æ–‡ä»¶æƒé™æ¨¡å—
- **åŠŸèƒ½**: è‡ªåŠ¨è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™
- **å½±å“**: ç¡®ä¿webæœåŠ¡å™¨èƒ½å¤Ÿè®¿é—®æ–‡ä»¶
- **é…ç½®**:
  - é¡¹ç›®æ–‡ä»¶: www:www æˆ– nginx:nginx
  - è„šæœ¬æ–‡ä»¶: å¯æ‰§è¡Œæƒé™

### 4. å¤‡ä»½æ¢å¤æ¨¡å—
- **åŠŸèƒ½**: åŒæ­¥å‰è‡ªåŠ¨å¤‡ä»½ç°æœ‰é¡¹ç›®
- **å½±å“**: æä¾›å¿«é€Ÿå›æ»šèƒ½åŠ›ï¼Œé™ä½åŒæ­¥é£é™©
- **ä½ç½®**: `/www/backup/æ—¥æœŸæ—¶é—´_sync_backup/`

---

## ğŸ“Š åŒæ­¥åéªŒè¯

### 1. æ£€æŸ¥æ–‡ä»¶åŒæ­¥çŠ¶æ€
```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /www/wwwroot/stock-tracker

# æŸ¥çœ‹å½“å‰ç‰ˆæœ¬
git log -1 --oneline

# éªŒè¯å…³é”®æ–‡ä»¶
ls -la baota-deploy.sh server-env-check.sh
ls -la src/components/StockTracker.tsx
```

### 2. éªŒè¯éƒ¨ç½²è„šæœ¬
```bash
# æ£€æŸ¥éƒ¨ç½²è„šæœ¬æƒé™
ls -la *.sh

# æµ‹è¯•ç¯å¢ƒæ£€æµ‹è„šæœ¬
./server-env-check.sh
```

### 3. æ£€æŸ¥åº”ç”¨çŠ¶æ€
```bash
# æŸ¥çœ‹PM2è¿›ç¨‹
pm2 status

# æ£€æŸ¥åº”ç”¨è®¿é—®
curl -I https://stock-tracker.yushuo.click
```

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1: Gitæƒé™é”™è¯¯
**ç—‡çŠ¶**: `Permission denied (publickey)`
**è§£å†³**:
```bash
# ä½¿ç”¨HTTPSè€ŒéSSH
git remote set-url origin https://github.com/yushuo1991/911.git
```

### é—®é¢˜2: æ–‡ä»¶æƒé™é—®é¢˜
**ç—‡çŠ¶**: åº”ç”¨æ— æ³•è®¿é—®æ–‡ä»¶
**è§£å†³**:
```bash
# é‡æ–°è®¾ç½®æƒé™
chown -R www:www /www/wwwroot/stock-tracker
find /www/wwwroot/stock-tracker -name "*.sh" -exec chmod +x {} \;
```

### é—®é¢˜3: ç‰ˆæœ¬å†²çª
**ç—‡çŠ¶**: Gitæ— æ³•åˆ‡æ¢ç‰ˆæœ¬
**è§£å†³**:
```bash
# å¼ºåˆ¶é‡ç½®åˆ°ç›®æ ‡ç‰ˆæœ¬
git fetch --tags
git reset --hard v4.3
```

### é—®é¢˜4: ä¾èµ–é—®é¢˜
**ç—‡çŠ¶**: åº”ç”¨å¯åŠ¨å¤±è´¥ï¼Œä¾èµ–ç¼ºå¤±
**è§£å†³**:
```bash
# é‡æ–°å®‰è£…ä¾èµ–
npm install
npm run build
pm2 restart stock-tracker-v42
```

---

## ğŸ”„ å›æ»šæ–¹æ¡ˆ

### å¿«é€Ÿå›æ»šåˆ°åŒæ­¥å‰çŠ¶æ€
```bash
# æŸ¥æ‰¾å¤‡ä»½ç›®å½•
ls -la /www/backup/ | grep sync_backup

# æ¢å¤å¤‡ä»½ï¼ˆæ›¿æ¢ä¸ºå®é™…å¤‡ä»½ç›®å½•åï¼‰
BACKUP_DIR="/www/backup/20250926_123456_sync_backup"
cd /www/wwwroot/yushuo.click/
rm -rf cc
cp -r $BACKUP_DIR/cc ./

# é‡å¯åº”ç”¨
pm2 restart stock-tracker-v42
```

### å›æ»šåˆ°ç‰¹å®šç‰ˆæœ¬
```bash
cd /www/wwwroot/stock-tracker
git checkout v4.2
git reset --hard v4.2
npm run build
pm2 restart stock-tracker-v42
```

---

## ğŸ“ˆ éƒ¨ç½²æµç¨‹ä¼˜åŒ–å»ºè®®

### 1. è‡ªåŠ¨åŒ–æ”¹è¿›
- è€ƒè™‘é…ç½®SSHå¯†é’¥å…å¯†ç è®¿é—®
- è®¾ç½®å®šæ—¶åŒæ­¥ä»»åŠ¡ (crontab)
- é›†æˆå®å¡”é¢æ¿webhookåŠŸèƒ½

### 2. ç›‘æ§å‘Šè­¦
- é…ç½®åº”ç”¨ç›‘æ§å‘Šè­¦
- è®¾ç½®ç£ç›˜ç©ºé—´ç›‘æ§
- æ—¥å¿—è‡ªåŠ¨è½®è½¬é…ç½®

### 3. æ€§èƒ½ä¼˜åŒ–
- å¯ç”¨Nginxé™æ€æ–‡ä»¶ç¼“å­˜
- é…ç½®CDNåŠ é€Ÿé™æ€èµ„æº
- æ•°æ®åº“å®šæœŸæ¸…ç†ä¼˜åŒ–

---

## ğŸ“ åŒæ­¥å®Œæˆæ£€æŸ¥æ¸…å•

åŒæ­¥å®Œæˆåï¼Œè¯·ç¡®è®¤ä»¥ä¸‹é¡¹ç›®ï¼š

- [ ] Gitç‰ˆæœ¬å·²åˆ‡æ¢åˆ°v4.3
- [ ] å…³é”®æ–‡ä»¶å­˜åœ¨ä¸”å®Œæ•´
- [ ] éƒ¨ç½²è„šæœ¬å…·æœ‰æ‰§è¡Œæƒé™
- [ ] PM2è¿›ç¨‹è¿è¡Œæ­£å¸¸
- [ ] ç½‘ç«™https://stock-tracker.yushuo.clickå¯æ­£å¸¸è®¿é—®
- [ ] åº”ç”¨åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] æ—¥å¿—è®°å½•æ­£å¸¸

---

**ğŸ‰ åŒæ­¥å®Œæˆåï¼Œæ‚¨çš„æœåŠ¡å™¨å°†è¿è¡Œv4.3ç‰ˆæœ¬çš„å®Œæ•´éƒ¨ç½²æ–¹æ¡ˆï¼**