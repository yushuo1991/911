# v4.8.17 æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## ğŸ“¦ ç‰ˆæœ¬ä¿¡æ¯
- **ç‰ˆæœ¬å·**: v4.8.17
- **åŠŸèƒ½**: æ¶¨åœæ•°å¼¹çª—æ·»åŠ æ¿å—æˆäº¤é¢æ˜¾ç¤º
- **æäº¤ID**: e6d478d
- **éƒ¨ç½²æ—¶é—´**: 2025-10-13

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²ï¼ˆæ¨èï¼‰

### æ–¹æ³•1: ä½¿ç”¨éƒ¨ç½²è„šæœ¬ï¼ˆæœ€ç®€å•ï¼‰

1. **é€šè¿‡å®å¡”é¢æ¿ç»ˆç«¯æˆ–SSHç™»å½•æœåŠ¡å™¨**

2. **ä¸‹è½½å¹¶æ‰§è¡Œéƒ¨ç½²è„šæœ¬**ï¼š
```bash
cd /www/wwwroot/stock-tracker
curl -O https://raw.githubusercontent.com/yushuo1991/911/main/DEPLOY-v4.8.17.sh
chmod +x DEPLOY-v4.8.17.sh
./DEPLOY-v4.8.17.sh
```

3. **ç­‰å¾…çº¦2-3åˆ†é’Ÿï¼Œéƒ¨ç½²å®Œæˆ**

---

### æ–¹æ³•2: æ‰‹åŠ¨éƒ¨ç½²ï¼ˆåˆ†æ­¥æ‰§è¡Œï¼‰

#### æ­¥éª¤1: ç™»å½•æœåŠ¡å™¨
```bash
ssh root@yushuo.click
# æˆ–ä½¿ç”¨å®å¡”é¢æ¿ç»ˆç«¯
```

#### æ­¥éª¤2: è¿›å…¥é¡¹ç›®ç›®å½•
```bash
cd /www/wwwroot/stock-tracker
pwd  # ç¡®è®¤å½“å‰ç›®å½•
```

#### æ­¥éª¤3: æ‹‰å–æœ€æ–°ä»£ç 
```bash
git pull origin main
```

å¦‚æœé‡åˆ°å†²çªï¼Œå…ˆstashæœ¬åœ°æ”¹åŠ¨ï¼š
```bash
git stash
git pull origin main
```

#### æ­¥éª¤4: åœæ­¢å®¹å™¨
```bash
docker compose down
```

#### æ­¥éª¤5: é‡æ–°æ„å»ºé•œåƒ
```bash
docker compose build --no-cache
```

#### æ­¥éª¤6: å¯åŠ¨å®¹å™¨
```bash
docker compose up -d
```

#### æ­¥éª¤7: éªŒè¯éƒ¨ç½²
```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker compose ps

# æŸ¥çœ‹æ—¥å¿—
docker compose logs --tail=50 app

# æµ‹è¯•API
curl -I http://localhost:3000/api/stocks?date=2025-10-13&mode=7days
```

---

## âœ… åŠŸèƒ½éªŒè¯

éƒ¨ç½²å®Œæˆåï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š**http://bk.yushuo.click**

### éªŒè¯æ¸…å•ï¼š

1. **é¦–é¡µæ¿å—å¡ç‰‡**ï¼š
   - [ ] æ¿å—åç§°ä¸‹æ–¹æ˜¾ç¤ºé»„è‰²å¾½ç« ï¼ˆğŸ’°XXXäº¿ï¼‰
   - [ ] æ•°å€¼åˆç†ï¼ˆäº¿å…ƒå•ä½ï¼Œ2ä½å°æ•°ï¼‰

2. **æ¶¨åœæ•°å¼¹çª—**ï¼š
   - [ ] ç‚¹å‡»æ—¥æœŸå¤´éƒ¨çš„"XXåªæ¶¨åœ"
   - [ ] æ¯ä¸ªæ¿å—æ ‡é¢˜ä¸‹æ–¹æ˜¾ç¤ºğŸ’°æˆäº¤é¢
   - [ ] å¸ƒå±€ç´§å‡‘ï¼ˆ2è¡Œï¼šåç§°+é‡‘é¢ï¼‰
   - [ ] æŒ‰é’®ï¼ˆğŸ“ŠMã€ğŸ“ˆKï¼‰æ­£å¸¸æ˜¾ç¤º

3. **æ ·å¼ç»Ÿä¸€**ï¼š
   - [ ] é¦–é¡µå’Œå¼¹çª—ä½¿ç”¨ç›¸åŒçš„é»„è‰²å¾½ç« 
   - [ ] åªåœ¨æˆäº¤é¢ > 0 æ—¶æ˜¾ç¤º

---

## ğŸ”§ å¸¸è§é—®é¢˜

### 1. Git pullå¤±è´¥
```bash
# é‡ç½®æœ¬åœ°æ”¹åŠ¨
git reset --hard HEAD
git pull origin main
```

### 2. Dockeræ„å»ºå¤±è´¥
```bash
# æ¸…ç†Dockerç¼“å­˜
docker system prune -a
docker compose build --no-cache
```

### 3. å®¹å™¨å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker compose logs -f app

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep 3000
```

### 4. é¡µé¢æ˜¾ç¤ºå¼‚å¸¸
```bash
# å¼ºåˆ¶åˆ·æ–°æµè§ˆå™¨ç¼“å­˜
Ctrl + Shift + R (Chrome/Edge)
Cmd + Shift + R (Mac)
```

---

## ğŸ”™ å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬

å¦‚æœéƒ¨ç½²åå‡ºç°é—®é¢˜ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å›æ»šï¼š

```bash
cd /www/wwwroot/stock-tracker

# å›æ»šä»£ç åˆ°ä¸Šä¸€ä¸ªæäº¤
git log --oneline -5  # æŸ¥çœ‹æœ€è¿‘5æ¬¡æäº¤
git reset --hard 22e3143  # ä½¿ç”¨ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬çš„commit ID

# é‡æ–°éƒ¨ç½²
docker compose down
docker compose build --no-cache
docker compose up -d
```

---

## ğŸ“Š æ€§èƒ½ç›‘æ§

éƒ¨ç½²åç›‘æ§å…³é”®æŒ‡æ ‡ï¼š

```bash
# æŸ¥çœ‹å®¹å™¨èµ„æºå ç”¨
docker stats stock-tracker-app-1

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker compose logs -f --tail=100 app

# æ£€æŸ¥APIå“åº”æ—¶é—´
curl -w "\nTime: %{time_total}s\n" http://localhost:3000/api/stocks?date=2025-10-13&mode=7days
```

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v4.8.17 (2025-10-13)
- âœ¨ **æ–°åŠŸèƒ½**: æ¶¨åœæ•°å¼¹çª—æ·»åŠ æ¿å—æˆäº¤é¢æ˜¾ç¤º
- ğŸ¨ **æ ·å¼ä¼˜åŒ–**: flex-colå‚ç›´å¸ƒå±€ï¼Œä¿æŒå†…å®¹ç´§å‡‘
- ğŸ› **Bugä¿®å¤**: æ— 
- ğŸ“¦ **ä¾èµ–æ›´æ–°**: æ— 

### v4.8.16 (ä¹‹å‰)
- âœ¨ æ·»åŠ ä¸ªè‚¡æˆäº¤é¢åˆ—åˆ°å¼¹çª—è¡¨æ ¼

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœéƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥çœ‹å®Œæ•´æ—¥å¿—**ï¼š
   ```bash
   docker compose logs --tail=200 app > /tmp/deploy-log.txt
   cat /tmp/deploy-log.txt
   ```

2. **æ£€æŸ¥ç¯å¢ƒå˜é‡**ï¼š
   ```bash
   cat .env.local
   ```

3. **é‡å¯æ‰€æœ‰æœåŠ¡**ï¼š
   ```bash
   docker compose down
   docker compose up -d
   ```

---

**éƒ¨ç½²å®Œæˆåï¼Œè¯·åœ¨æµè§ˆå™¨ä¸­éªŒè¯åŠŸèƒ½æ­£å¸¸ï¼Œç„¶ååœ¨Claude Codeä¸­å›å¤"éƒ¨ç½²å®Œæˆ"ï¼** âœ…
