╔══════════════════════════════════════════════════════════════╗
║         📡 v4.20 服务器直接部署命令（无需GitHub）             ║
╚══════════════════════════════════════════════════════════════╝

执行环境: 服务器宝塔终端或SSH
执行位置: /www/wwwroot/stock-tracker
版本: v4.20 超精细化溢价徽章

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🚀 一键部署命令（复制整段到宝塔终端执行）

cd /www/wwwroot/stock-tracker && \
echo "🔄 备份当前文件..." && \
cp src/app/page.tsx src/app/page.tsx.backup-$(date +%Y%m%d-%H%M%S) && \
echo "✅ 备份完成" && \
echo "" && \
echo "🔧 应用v4.20超精细化改动..." && \
sed -i '972,982s/text-\[7px\]/text-[6px]/g' src/app/page.tsx && \
sed -i '972,982s/py-0\.5/py-[2px]/g' src/app/page.tsx && \
sed -i '997s/text-\[7px\]/text-[6px]/' src/app/page.tsx && \
sed -i '1005s/px-1 py-0\.5 rounded text-\[7px\] font-bold/px-[3px] rounded-sm text-[6px] font-bold leading-none/' src/app/page.tsx && \
sed -i '1017s/px-0\.5 rounded text-\[7px\] font-medium/px-[2px] rounded-sm text-[6px] font-medium leading-none/' src/app/page.tsx && \
sed -i '1024s/px-0\.5 rounded text-\[7px\] font-bold/px-[2px] rounded-sm text-[6px] font-bold leading-none/' src/app/page.tsx && \
echo "✅ 代码修改完成" && \
echo "" && \
echo "🔍 验证修改..." && \
grep -n "text-\[6px\]" src/app/page.tsx | head -3 && \
grep -n "leading-none" src/app/page.tsx | head -2 && \
echo "" && \
echo "🛑 停止旧容器..." && \
docker compose down && \
echo "" && \
echo "🔨 重新构建（使用缓存避免超时）..." && \
docker compose build && \
echo "" && \
echo "🚀 启动新容器..." && \
docker compose up -d && \
echo "" && \
echo "⏳ 等待20秒..." && \
sleep 20 && \
echo "" && \
echo "🔍 检查状态:" && \
docker ps | grep stock-tracker && \
curl -I http://localhost:3002 && \
echo "" && \
echo "✅ v4.20 部署完成！访问 http://bk.yushuo.click 验证（Ctrl+Shift+R刷新）"

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📊 v4.20 改动详情

字号压缩:
  表头: 7px → 6px
  个股名: 7px → 6px
  状态: 7px → 6px
  溢价值: 7px → 6px

Padding优化:
  表头垂直: py-0.5 → py-[2px]
  状态徽章: px-1 → px-[3px]
  溢价徽章: px-0.5 → px-[2px]

样式精细化:
  圆角: rounded (4px) → rounded-sm (2px)
  行高: 默认 → leading-none (压缩20-25%)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔍 浏览器验证要点

1. 访问 http://bk.yushuo.click
2. 按 Ctrl+Shift+R 强制刷新
3. 点击任意日期涨停数（如"73只涨停"）
4. 观察弹窗变化:
   ✅ 溢价色块明显变小
   ✅ 字号更精致（6px）
   ✅ 圆角更精致（2px）
   ✅ 整体数据密度更高
   ✅ 3-4列网格布局保持不变
   ✅ 无横向滚动条

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🆘 如果遇到问题

构建超时/EOF错误:
  docker compose down
  docker image prune -f
  docker compose build  # 不用--no-cache
  docker compose up -d

检查修改是否生效:
  grep "text-\[6px\]" src/app/page.tsx
  grep "leading-none" src/app/page.tsx

查看容器日志:
  docker compose logs --tail=50 app

恢复备份:
  cp src/app/page.tsx.backup-* src/app/page.tsx
  docker compose down && docker compose up -d --build

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Created: 2025-10-03
Version: v4.20
Purpose: 超精细化溢价徽章优化，提升视觉精致度
