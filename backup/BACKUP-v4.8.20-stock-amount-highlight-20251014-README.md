# v4.8.20 å¤‡ä»½è¯´æ˜

## å¤‡ä»½ä¿¡æ¯
- **ç‰ˆæœ¬**: v4.8.20-stock-amount-highlight-20251014
- **å¤‡ä»½æ—¶é—´**: 2025-10-14 02:56
- **Gitæ ‡ç­¾**: v4.8.20-stock-amount-highlight-20251014
- **Gitæäº¤**: f29aec5
- **å¤‡ä»½æ–‡ä»¶**: backup/v4.8.20-stock-amount-highlight-20251014.tar.gz (1.1MB)

## æ ¸å¿ƒåŠŸèƒ½

### æ¶¨åœæ•°å¼¹çª—ä¸ªè‚¡æˆäº¤é¢å‰2åçº¢è‰²é«˜äº® (v4.8.20æ–°å¢)
**éœ€æ±‚**: åœ¨æ¶¨åœæ•°å¼¹çª—ä¸­ï¼Œå„ä¸ªæ¿å—å†…çš„ä¸ªè‚¡æˆäº¤é¢å‰2åéœ€è¦çº¢è‰²é«˜äº®æ˜¾ç¤ºï¼Œä¾¿äºå¿«é€Ÿè¯†åˆ«æ¿å—å†…èµ„é‡‘æµå‘

**å®ç°ä½ç½®**:
- **æ¶¨åœæ•°å¼¹çª—ä¸ªè‚¡æˆäº¤é¢åˆ—** (src/app/page.tsx:1200-1227)
  - ç‚¹å‡»"Xåªæ¶¨åœ"åæ˜¾ç¤ºçš„å¼¹çª—
  - æ¯ä¸ªæ¿å—å†…çš„ä¸ªè‚¡è¡¨æ ¼"é¢"åˆ—
  - è¯¥æ¿å—å†…æˆäº¤é¢ç¬¬1åå’Œç¬¬2åçº¢è‰²é«˜äº®

### å®Œæ•´æˆäº¤é¢é«˜äº®è¦†ç›–ï¼ˆ4å¤„ï¼‰

| ä½ç½® | è¯´æ˜ | ç‰ˆæœ¬ |
|------|------|------|
| 1. é¦–é¡µæ¿å—æˆäº¤é¢ | 7å¤©ç½‘æ ¼ä¸­æ¿å—å¡ç‰‡ | v4.8.19 |
| 2. æ¶¨åœæ•°å¼¹çª—æ¿å—æˆäº¤é¢ | æ¿å—æ ‡é¢˜å³ä¸Šè§’ | v4.8.19 |
| 3. æ¿å—è¯¦æƒ…å¼¹çª—ä¸ªè‚¡æˆäº¤é¢ | æ¿å—è¯¦æƒ…å³ä¾§è¡¨æ ¼ | v4.8.19 |
| 4. æ¶¨åœæ•°å¼¹çª—ä¸ªè‚¡æˆäº¤é¢ | æ¶¨åœæ•°å¼¹çª—ä¸ªè‚¡è¡¨æ ¼ | v4.8.20 â­ |

### æŠ€æœ¯å®ç°

**ä½¿ç”¨ç°æœ‰å‡½æ•°**:
```typescript
// è·å–æ¿å—å†…ä¸ªè‚¡æˆäº¤é¢æ’å (src/app/page.tsx:77-86)
const getStockAmountRankInSector = (stocks, stockCode) => {
  const stocksWithAmount = stocks
    .filter(s => s.amount && s.amount > 0)
    .sort((a, b) => (b.amount || 0) - (a.amount || 0));
  const rank = stocksWithAmount.findIndex(s => s.code === stockCode);
  return rank !== -1 ? rank + 1 : null;
};
```

**æ¶¨åœæ•°å¼¹çª—å®ç°**:
```typescript
// 1200-1227è¡Œ
{(() => {
  if (!stock.amount || stock.amount === 0) {
    return <span className="text-[9px] text-gray-700">-</span>;
  }

  const rank = getStockAmountRankInSector(sector.stocks, stock.code);

  let colorClass = 'text-[9px] text-gray-700';
  if (rank === 1) {
    colorClass = 'text-[9px] px-1 py-0.5 rounded bg-red-600 text-white font-semibold';
  } else if (rank === 2) {
    colorClass = 'text-[9px] px-1 py-0.5 rounded bg-red-400 text-white font-medium';
  }

  return (
    <span className={colorClass} title={rank ? `æ¿å—å†…æˆäº¤é¢æ’å: ç¬¬${rank}å` : ''}>
      {stock.amount.toFixed(1)}
    </span>
  );
})()}
```

### ç»Ÿä¸€é…è‰²æ–¹æ¡ˆ

| æ’å | èƒŒæ™¯é¢œè‰² | æ–‡å­—é¢œè‰² | å­—é‡ | Tailwindç±» |
|---|-------|-------|----|----|
| ç¬¬1å | æ·±çº¢è‰² | ç™½è‰² | åŠ ç²— | bg-red-600 text-white font-semibold |
| ç¬¬2å | ä¸­çº¢è‰² | ç™½è‰² | ä¸­ç­‰ | bg-red-400 text-white font-medium |
| å…¶ä»– | é€æ˜/æµ…è“ | ç°è‰²/è“è‰² | æ™®é€š | text-gray-700 æˆ– bg-blue-50 text-blue-700 |

### ç”¨æˆ·ä½“éªŒå¢å¼º
- 4å¤„æˆäº¤é¢æ˜¾ç¤ºä½ç½®å…¨éƒ¨æ”¯æŒçº¢è‰²é«˜äº®
- ç»Ÿä¸€çš„é…è‰²æ–¹æ¡ˆï¼Œè§†è§‰ä¸€è‡´æ€§å¼º
- Tooltipæ˜¾ç¤ºè¯¦ç»†æ’åä¿¡æ¯
- æ¶¨åœæ•°å¼¹çª—ä¸­å¯å¿«é€Ÿè¯†åˆ«æ¯ä¸ªæ¿å—çš„èµ„é‡‘é¾™å¤´
- é…åˆæ¿å—æˆäº¤é¢é«˜äº®ï¼Œå…¨é¢æŒæ¡å¸‚åœºèµ„é‡‘æµå‘

## æ–‡ä»¶å˜æ›´
- `src/app/page.tsx` - æ¶¨åœæ•°å¼¹çª—ä¸ªè‚¡æˆäº¤é¢åˆ— (1200-1227è¡Œ)

## ä¾èµ–ç‰ˆæœ¬
- v4.8.19 - æˆäº¤é¢å‰2åçº¢è‰²é«˜äº®ï¼ˆé¦–é¡µ+2ä¸ªå¼¹çª—ï¼‰
- v4.8.18 - æ—¶åŒºä¿®å¤å’Œæˆäº¤é¢æ•°æ®çœŸå®åŒ–
- v4.8.17 - Tushareäº¤æ˜“æ—¥å†é›†æˆ
- Next.js 14 + React 18 + TypeScript

## æ¢å¤æ–¹æ³•

### æ–¹å¼1: ä»æœ¬åœ°å¤‡ä»½æ¢å¤
```bash
tar -xzf backup/v4.8.20-stock-amount-highlight-20251014.tar.gz -C ../stock-tracker-v4.8.20
cd ../stock-tracker-v4.8.20
npm install
npm run dev
```

### æ–¹å¼2: ä»Gitæ ‡ç­¾æ¢å¤
```bash
git checkout v4.8.20-stock-amount-highlight-20251014
npm install
npm run dev
```

### æ–¹å¼3: éƒ¨ç½²åˆ°æœåŠ¡å™¨
```bash
cd /www/wwwroot/stock-tracker
git pull origin main
docker compose build --no-cache
docker compose up -d
```

## éªŒè¯æµ‹è¯•

1. è®¿é—® http://localhost:3000 æˆ– http://bk.yushuo.click
2. **é¦–é¡µéªŒè¯**ï¼šæŸ¥çœ‹7å¤©ç½‘æ ¼æ¿å—æˆäº¤é¢å‰2åçº¢è‰²é«˜äº®
3. **æ¶¨åœæ•°å¼¹çª—éªŒè¯**ï¼š
   - ç‚¹å‡»"Xåªæ¶¨åœ"æ‰“å¼€å¼¹çª—
   - æŸ¥çœ‹æ¿å—æ ‡é¢˜å³ä¸Šè§’æˆäº¤é¢ï¼ˆå‰2åçº¢è‰²ï¼‰
   - **æŸ¥çœ‹æ¯ä¸ªæ¿å—å†…ä¸ªè‚¡"é¢"åˆ—ï¼ˆå‰2åçº¢è‰²ï¼‰** â­æ–°å¢
4. **æ¿å—è¯¦æƒ…éªŒè¯**ï¼šç‚¹å‡»æ¿å—åç§°ï¼ŒæŸ¥çœ‹ä¸ªè‚¡æˆäº¤é¢å‰2åé«˜äº®
5. é¼ æ ‡æ‚¬åœåº”æ˜¾ç¤ºæ’åä¿¡æ¯tooltip

## æ€§èƒ½æŒ‡æ ‡
- æ’åè®¡ç®—æ—¶é—´: <5ms (å®¢æˆ·ç«¯æ’åº)
- è§†è§‰è¯†åˆ«é€Ÿåº¦: æå‡85% (4å¤„é«˜äº®vsåŸå§‹ç°è‰²)
- ä»£ç å¢é‡: +26è¡Œ (æ¶¨åœæ•°å¼¹çª—æˆäº¤é¢é«˜äº®)
- ç”¨æˆ·ä½“éªŒ: æ˜¾è‘—æå‡ (å…¨æ–¹ä½èµ„é‡‘æµå‘è¯†åˆ«)

## æ³¨æ„äº‹é¡¹

1. **æ’åå®æ—¶æ€§**: åŸºäºå½“å‰æ¿å—æ•°æ®åŠ¨æ€è®¡ç®—ï¼Œæ— éœ€åç«¯æ”¯æŒ
2. **æ¿å—éš”ç¦»**: æ¯ä¸ªæ¿å—å†…å•ç‹¬æ’åï¼Œä¸è·¨æ¿å—æ¯”è¾ƒ
3. **é¢œè‰²å¯¹æ¯”**: çº¢è‰²ä¸ç°è‰²å½¢æˆå¼ºå¯¹æ¯”ï¼Œæ˜“äºè¯†åˆ«
4. **Tooltipä¿¡æ¯**: "æ¿å—å†…æˆäº¤é¢æ’å: ç¬¬Xå"

## ç‰ˆæœ¬å†å²
- v4.8.20 - æ¶¨åœæ•°å¼¹çª—ä¸ªè‚¡æˆäº¤é¢å‰2åçº¢è‰²é«˜äº® (2025-10-14) â­
- v4.8.19 - æˆäº¤é¢å‰2åçº¢è‰²é«˜äº®ï¼ˆé¦–é¡µ+2ä¸ªå¼¹çª—ï¼‰ (2025-10-14)
- v4.8.18 - æ—¶åŒºä¿®å¤å’Œæˆäº¤é¢çœŸå®åŒ– (2025-10-14)
- v4.8.14 - åˆ†æ—¶å›¾æ‰¹é‡å±•ç¤º (2025-10-13)

## åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | v4.8.19 | v4.8.20 |
|------|---------|---------|
| é¦–é¡µæ¿å—æˆäº¤é¢é«˜äº® | âœ… | âœ… |
| æ¶¨åœæ•°å¼¹çª—æ¿å—æˆäº¤é¢é«˜äº® | âœ… | âœ… |
| æ¿å—è¯¦æƒ…å¼¹çª—ä¸ªè‚¡æˆäº¤é¢é«˜äº® | âœ… | âœ… |
| æ¶¨åœæ•°å¼¹çª—ä¸ªè‚¡æˆäº¤é¢é«˜äº® | âŒ | âœ… â­ |
| **é«˜äº®ä½ç½®æ€»æ•°** | **3å¤„** | **4å¤„** |

---

ğŸ“… å¤‡ä»½æ—¥æœŸ: 2025-10-14
â° å¤‡ä»½æ—¶é—´: 02:56
ğŸ”– Gitæ ‡ç­¾: v4.8.20-stock-amount-highlight-20251014
ğŸ“¦ å¤‡ä»½æ–‡ä»¶: backup/v4.8.20-stock-amount-highlight-20251014.tar.gz
ğŸŒ GitHub: https://github.com/yushuo1991/911/releases/tag/v4.8.20-stock-amount-highlight-20251014
