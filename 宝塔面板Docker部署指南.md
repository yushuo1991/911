# å®å¡”é¢æ¿Dockeréƒ¨ç½²æŒ‡å—

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- **æœåŠ¡å™¨**: Linuxç³»ç»Ÿ (CentOS 7+/Ubuntu 18.04+)
- **å®å¡”é¢æ¿**: 7.7.0+ ç‰ˆæœ¬
- **Docker**: å·²å®‰è£…Dockerå’ŒDocker Compose
- **ç«¯å£**: ç¡®ä¿3000ç«¯å£å¯ç”¨

## ğŸš€ å¿«é€Ÿéƒ¨ç½²æ­¥éª¤

### 1. å‡†å¤‡å·¥ä½œ

åœ¨å®å¡”é¢æ¿ä¸­å®‰è£…Dockerç®¡ç†å™¨:
- è¿›å…¥å®å¡”é¢æ¿ â†’ è½¯ä»¶å•†åº— â†’ Dockerç®¡ç†å™¨ â†’ å®‰è£…

### 2. ä¸Šä¼ é¡¹ç›®æ–‡ä»¶

å°†é¡¹ç›®æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œæ¨èä½ç½®:
```bash
/www/wwwroot/stock-tracker/
```

### 3. ä¸€é”®éƒ¨ç½²

åœ¨é¡¹ç›®ç›®å½•æ‰§è¡Œéƒ¨ç½²è„šæœ¬:
```bash
chmod +x deploy.sh
./deploy.sh
```

### 4. å®å¡”é¢æ¿åå‘ä»£ç†é…ç½®

åœ¨å®å¡”é¢æ¿ä¸­è®¾ç½®åå‘ä»£ç†:

1. **åˆ›å»ºç½‘ç«™**:
   - åŸŸå: your-domain.com (æˆ–å­åŸŸå)
   - æ ¹ç›®å½•: éšæ„é€‰æ‹©ä¸€ä¸ªç›®å½•

2. **é…ç½®åå‘ä»£ç†**:
   - è¿›å…¥ç½‘ç«™è®¾ç½® â†’ åå‘ä»£ç† â†’ æ·»åŠ åå‘ä»£ç†
   - ä»£ç†åç§°: stock-tracker
   - ç›®æ ‡URL: http://127.0.0.1:3000
   - å‘é€åŸŸå: $host
   - ä¿å­˜é…ç½®

3. **SSLè¯ä¹¦** (å¯é€‰):
   - ç½‘ç«™è®¾ç½® â†’ SSL â†’ Let's Encrypt â†’ ç”³è¯·å…è´¹è¯ä¹¦

## ğŸ“Š ä½¿ç”¨Docker Composeéƒ¨ç½²

ä¹Ÿå¯ä»¥ä½¿ç”¨Docker Composeè¿›è¡Œéƒ¨ç½²:

```bash
# æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d

# æŸ¥çœ‹çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down
```

## ğŸ”§ å¸¸ç”¨ç®¡ç†å‘½ä»¤

### å®¹å™¨ç®¡ç†
```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps | grep stock-tracker

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker logs -f stock-tracker-app

# é‡å¯å®¹å™¨
docker restart stock-tracker-app

# è¿›å…¥å®¹å™¨
docker exec -it stock-tracker-app sh

# åœæ­¢å®¹å™¨
docker stop stock-tracker-app
```

### é•œåƒç®¡ç†
```bash
# æŸ¥çœ‹é•œåƒ
docker images | grep stock-tracker

# åˆ é™¤é•œåƒ
docker rmi stock-tracker

# æ¸…ç†æ— ç”¨é•œåƒ
docker image prune -f
```

## ğŸŒ åŸŸåé…ç½®

### ä¸»åŸŸåéƒ¨ç½²
å¦‚æœè¦åœ¨ä¸»åŸŸåéƒ¨ç½² (å¦‚: yushuo.click):
- åå‘ä»£ç†ç›®æ ‡URL: http://127.0.0.1:3000
- é…ç½®æ ¹è·¯å¾„ä»£ç†: /

### å­åŸŸåéƒ¨ç½²
å¦‚æœè¦åœ¨å­åŸŸåéƒ¨ç½² (å¦‚: stock.yushuo.click):
- åˆ›å»ºå­åŸŸåç½‘ç«™
- åå‘ä»£ç†ç›®æ ‡URL: http://127.0.0.1:3000

### å­ç›®å½•éƒ¨ç½²
å¦‚æœè¦åœ¨å­ç›®å½•éƒ¨ç½² (å¦‚: yushuo.click/stock):
- åå‘ä»£ç†è·¯å¾„: /stock
- ç›®æ ‡URL: http://127.0.0.1:3000
- éœ€è¦ä¿®æ”¹Next.jsé…ç½®çš„basePath

## ğŸ”„ æ›´æ–°éƒ¨ç½²

å½“éœ€è¦æ›´æ–°åº”ç”¨æ—¶:

1. **æ‹‰å–æœ€æ–°ä»£ç **:
   ```bash
   git pull origin main
   ```

2. **é‡æ–°éƒ¨ç½²**:
   ```bash
   ./deploy.sh
   ```

## ğŸ“ ç¯å¢ƒå˜é‡é…ç½®

åœ¨.envæ–‡ä»¶ä¸­é…ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡:
```env
NODE_ENV=production
TUSHARE_TOKEN=your_tushare_token_here
```

## ğŸ› æ•…éšœæ’é™¤

### 1. å®¹å™¨æ— æ³•å¯åŠ¨
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker logs stock-tracker-app

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep 3000
```

### 2. ç½‘ç«™æ— æ³•è®¿é—®
- æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å¼€æ”¾3000ç«¯å£
- ç¡®è®¤åå‘ä»£ç†é…ç½®æ­£ç¡®
- æ£€æŸ¥å®¹å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œ

### 3. APIæ•°æ®è·å–å¤±è´¥
- ç¡®è®¤.envæ–‡ä»¶ä¸­çš„TUSHARE_TOKENæ­£ç¡®
- æ£€æŸ¥æœåŠ¡å™¨ç½‘ç»œè¿æ¥
- æŸ¥çœ‹åº”ç”¨æ—¥å¿—æ’æŸ¥APIè°ƒç”¨é—®é¢˜

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. èµ„æºé™åˆ¶
```bash
# é™åˆ¶å®¹å™¨èµ„æºä½¿ç”¨
docker run -d \
  --name stock-tracker-app \
  --memory="512m" \
  --cpus="1" \
  -p 3000:3000 \
  stock-tracker
```

### 2. æ—¥å¿—ç®¡ç†
```bash
# è®¾ç½®æ—¥å¿—å¤§å°é™åˆ¶
docker run -d \
  --name stock-tracker-app \
  --log-opt max-size=10m \
  --log-opt max-file=3 \
  -p 3000:3000 \
  stock-tracker
```

## âœ… éƒ¨ç½²å®Œæˆæ£€æŸ¥

éƒ¨ç½²å®Œæˆåï¼Œè®¿é—®ä½ çš„åŸŸåï¼Œç¡®è®¤:
- [x] é¡µé¢æ­£å¸¸åŠ è½½
- [x] è‚¡ç¥¨æ•°æ®èƒ½æ­£å¸¸è·å–
- [x] æ—¥æœŸé€‰æ‹©åŠŸèƒ½æ­£å¸¸
- [x] Kçº¿å›¾å¼¹çª—æ­£å¸¸æ˜¾ç¤º
- [x] æ¿å—åˆ†æå›¾è¡¨æ­£å¸¸

---

**æŠ€æœ¯æ”¯æŒ**: å¦‚æœ‰é—®é¢˜è¯·æ£€æŸ¥å®¹å™¨æ—¥å¿—æˆ–è”ç³»æŠ€æœ¯æ”¯æŒ