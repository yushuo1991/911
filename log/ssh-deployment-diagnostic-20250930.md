# SSHè‡ªåŠ¨éƒ¨ç½²è¯Šæ–­æŠ¥å‘Š

**ç”Ÿæˆæ—¶é—´**: 2025-09-30
**è¯Šæ–­æœåŠ¡å™¨**: yushuo.click (75.2.60.5)
**é¡¹ç›®**: Stock Tracker è‡ªåŠ¨éƒ¨ç½²ç³»ç»Ÿ

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

**é—®é¢˜**: æ— æ³•é€šè¿‡SSHè¿æ¥åˆ°æœåŠ¡å™¨ yushuo.click è¿›è¡ŒGitè‡ªåŠ¨éƒ¨ç½²
**å½±å“**: æ— æ³•æ‰§è¡Œè¿œç¨‹éƒ¨ç½²æ“ä½œï¼Œéœ€è¦æ‰‹åŠ¨æˆ–ä½¿ç”¨æ›¿ä»£æ–¹æ¡ˆ
**æ ¹æœ¬åŸå› **: SSHç«¯å£è¢«é˜²ç«å¢™é˜»æ­¢æˆ–æœåŠ¡æœªå¯åŠ¨

---

## ğŸ” è¯Šæ–­è¯¦æƒ…

### 1. ç½‘ç»œè¿é€šæ€§æµ‹è¯•

#### Pingæµ‹è¯•ç»“æœ
```
ç›®æ ‡: yushuo.click (75.2.60.5)
ç»“æœ: âœ… æˆåŠŸ
- å‘é€: 4åŒ…
- æ¥æ”¶: 3åŒ…
- ä¸¢å¤±: 1åŒ… (25%)
- å¹³å‡å»¶è¿Ÿ: 232ms
```

**åˆ†æ**: æœåŠ¡å™¨ç½‘ç»œå¯è¾¾ï¼ŒåŸºç¡€ç½‘ç»œè¿æ¥æ­£å¸¸ã€‚

### 2. DNSè§£ææµ‹è¯•

```
åŸŸå: yushuo.click
IPåœ°å€: 75.2.60.5
çŠ¶æ€: âœ… è§£ææ­£å¸¸
```

**åˆ†æ**: DNSè§£æå·¥ä½œæ­£å¸¸ï¼ŒåŸŸåæŒ‡å‘æ­£ç¡®çš„IPåœ°å€ã€‚

### 3. SSHç«¯å£æµ‹è¯•

#### æµ‹è¯•çš„ç«¯å£:
- âŒ Port 22 (æ ‡å‡†SSH): **CLOSED/TIMEOUT**
- âŒ Port 2222 (å¤‡ç”¨SSH): **CLOSED/TIMEOUT**
- âŒ Port 2022 (å¤‡ç”¨SSH): **CLOSED/TIMEOUT**
- âŒ Port 8022 (å¤‡ç”¨SSH): **CLOSED/TIMEOUT**
- âŒ Port 10022 (å¤‡ç”¨SSH): **CLOSED/TIMEOUT**

**åˆ†æ**: æ‰€æœ‰å¸¸è§çš„SSHç«¯å£éƒ½æ— æ³•è¿æ¥ï¼Œè¡¨æ˜ï¼š
1. SSHæœåŠ¡å¯èƒ½æœªå¯åŠ¨
2. é˜²ç«å¢™é˜»æ­¢äº†SSHç«¯å£
3. SSHç›‘å¬åœ¨éæ ‡å‡†ç«¯å£ä¸Š

### 4. HTTPç«¯å£æµ‹è¯•

```
æµ‹è¯•ç«¯å£ 3002 (åº”ç”¨ç«¯å£): TIMEOUT (è¶…è¿‡10ç§’)
```

**åˆ†æ**: åº”ç”¨HTTPç«¯å£ä¹Ÿæ— æ³•è®¿é—®ï¼Œå¯èƒ½æ•´ä¸ªæœåŠ¡å™¨çš„é˜²ç«å¢™é…ç½®è¾ƒä¸¥æ ¼ã€‚

---

## ğŸ”§ é—®é¢˜åˆ†æ

### æ¶‰åŠæ¨¡å—
1. **SSHæœåŠ¡ (OpenSSH Server)**
   - åŠŸèƒ½: æä¾›å®‰å…¨çš„è¿œç¨‹ç™»å½•å’Œå‘½ä»¤æ‰§è¡Œ
   - å½“å‰çŠ¶æ€: ä¸å¯è®¿é—®
   - å½±å“: æ— æ³•è¿œç¨‹ç®¡ç†æœåŠ¡å™¨

2. **é˜²ç«å¢™ (iptables/firewalld/äº‘æœåŠ¡å•†å®‰å…¨ç»„)**
   - åŠŸèƒ½: æ§åˆ¶ç½‘ç»œæµé‡è¿›å‡º
   - å½“å‰çŠ¶æ€: å¯èƒ½é˜»æ­¢äº†SSHå’Œåº”ç”¨ç«¯å£
   - å½±å“: é˜»æ­¢å¤–éƒ¨è¿æ¥

3. **ç½‘ç»œé…ç½®**
   - åŸºç¡€ç½‘ç»œ: âœ… æ­£å¸¸
   - DNSè§£æ: âœ… æ­£å¸¸
   - ç«¯å£å¼€æ”¾: âŒ å¼‚å¸¸

---

## ğŸ’¡ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: æ£€æŸ¥äº‘æœåŠ¡å•†å®‰å…¨ç»„è®¾ç½® (æ¨è)

æœåŠ¡å™¨æ‰˜ç®¡åœ¨äº‘å¹³å°(IP: 75.2.60.5)ï¼Œéœ€è¦åœ¨äº‘æ§åˆ¶å°é…ç½®å®‰å…¨ç»„ï¼š

1. **ç™»å½•äº‘æœåŠ¡å•†æ§åˆ¶å°**
   - æ ¹æ®IPæ®µåˆ¤æ–­å¯èƒ½æ˜¯AWS/é˜¿é‡Œäº‘/è…¾è®¯äº‘ç­‰

2. **é…ç½®å®‰å…¨ç»„è§„åˆ™**
   ```
   å…¥ç«™è§„åˆ™:
   - SSH: TCP 22, æ¥æº: 0.0.0.0/0 (æˆ–ç‰¹å®šIP)
   - HTTP: TCP 3002, æ¥æº: 0.0.0.0/0
   - HTTPS: TCP 443, æ¥æº: 0.0.0.0/0
   ```

3. **åº”ç”¨å®‰å…¨ç»„åˆ°æœåŠ¡å™¨å®ä¾‹**

### æ–¹æ¡ˆ2: ä½¿ç”¨æœåŠ¡å™¨æ§åˆ¶å°

å¦‚æœäº‘å¹³å°æä¾›Webæ§åˆ¶å°æˆ–VNCè®¿é—®ï¼š

1. é€šè¿‡äº‘æ§åˆ¶å°çš„Webç»ˆç«¯ç™»å½•
2. æ£€æŸ¥SSHæœåŠ¡çŠ¶æ€:
   ```bash
   systemctl status sshd
   systemctl start sshd
   systemctl enable sshd
   ```

3. æ£€æŸ¥é˜²ç«å¢™è§„åˆ™:
   ```bash
   # CentOS/RHEL
   firewall-cmd --list-all
   firewall-cmd --add-service=ssh --permanent
   firewall-cmd --add-port=3002/tcp --permanent
   firewall-cmd --reload

   # Ubuntu/Debian
   ufw status
   ufw allow ssh
   ufw allow 3002/tcp
   ```

### æ–¹æ¡ˆ3: è”ç³»æœåŠ¡å™¨ç®¡ç†å‘˜

å¦‚æœæ‚¨ä¸æ˜¯æœåŠ¡å™¨çš„å”¯ä¸€ç®¡ç†å‘˜ï¼š
1. è”ç³»æœåŠ¡å™¨ç®¡ç†å‘˜æˆ–æ‰˜ç®¡æœåŠ¡å•†
2. è¯·æ±‚å¼€æ”¾SSHç«¯å£(22)å’Œåº”ç”¨ç«¯å£(3002)
3. ç¡®è®¤SSHæœåŠ¡æ˜¯å¦è¿è¡Œ

### æ–¹æ¡ˆ4: ä½¿ç”¨æ›¿ä»£éƒ¨ç½²æ–¹å¼

åœ¨SSHä¿®å¤ä¹‹å‰ï¼Œå¯ä»¥ä½¿ç”¨ï¼š

#### A. GitHub Actionsè‡ªåŠ¨éƒ¨ç½²
åˆ›å»º `.github/workflows/deploy.yml`:
```yaml
name: Deploy to Production

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Deploy via SSH
        uses: appleboy/ssh-action@master
        with:
          host: yushuo.click
          username: root
          password: ${{ secrets.SSH_PASSWORD }}
          script: |
            cd /www/wwwroot/stock-tracker
            git pull origin main
            chmod +x deploy.sh
            ./deploy.sh
```

#### B. Webhookéƒ¨ç½²
åœ¨æœåŠ¡å™¨ä¸Šé…ç½®webhookæ¥æ”¶å™¨ï¼Œä»GitHubæ¨é€è§¦å‘éƒ¨ç½²ã€‚

#### C. æœ¬åœ°æ„å»º+FTPéƒ¨ç½²
```bash
# æœ¬åœ°æ„å»º
npm run build

# ä½¿ç”¨SFTP/FTPä¸Šä¼ æ„å»ºäº§ç‰©
# (å¦‚æœFTPç«¯å£å¼€æ”¾çš„è¯)
```

---

## ğŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œ:
1. âœ… **æ£€æŸ¥äº‘æœåŠ¡å•†å®‰å…¨ç»„** - æœ€å¯èƒ½çš„é—®é¢˜
2. âœ… **å°è¯•ä½¿ç”¨äº‘æ§åˆ¶å°çš„Webç»ˆç«¯** - ç»•è¿‡SSHé™åˆ¶
3. âœ… **ç¡®è®¤SSHæœåŠ¡çŠ¶æ€** - é€šè¿‡æ§åˆ¶å°è®¿é—®

### ä¸­æœŸæ‰§è¡Œ:
4. é…ç½®GitHub Actionsè‡ªåŠ¨éƒ¨ç½² - ä½œä¸ºé•¿æœŸè§£å†³æ–¹æ¡ˆ
5. è®¾ç½®ç›‘æ§å‘Šè­¦ - é˜²æ­¢ç±»ä¼¼é—®é¢˜å†æ¬¡å‘ç”Ÿ
6. æ–‡æ¡£åŒ–éƒ¨ç½²æµç¨‹ - ä¾¿äºå›¢é˜Ÿå…¶ä»–æˆå‘˜æ“ä½œ

---

## ğŸ” å®‰å…¨å»ºè®®

1. **SSHå¯†é’¥è®¤è¯**: ä½¿ç”¨SSHå¯†é’¥æ›¿ä»£å¯†ç è®¤è¯
   ```bash
   ssh-keygen -t rsa -b 4096
   ssh-copy-id root@yushuo.click
   ```

2. **æ›´æ”¹SSHé»˜è®¤ç«¯å£**: å‡å°‘æš´åŠ›ç ´è§£é£é™©
   ```bash
   # /etc/ssh/sshd_config
   Port 2222
   ```

3. **é™åˆ¶SSHè®¿é—®IP**: ä»…å…è®¸ç‰¹å®šIPè®¿é—®
   ```bash
   # åœ¨å®‰å…¨ç»„æˆ–é˜²ç«å¢™ä¸­é…ç½®
   AllowUsers root@your-ip-address
   ```

4. **ä½¿ç”¨å ¡å’æœº**: å¢åŠ ä¸€å±‚å®‰å…¨é˜²æŠ¤

---

## ğŸ“Š æŠ€æœ¯çŸ¥è¯†ç‚¹

### SSH (Secure Shell)
- **ä½œç”¨**: åŠ å¯†çš„ç½‘ç»œåè®®ï¼Œç”¨äºå®‰å…¨çš„è¿œç¨‹ç™»å½•å’Œå‘½ä»¤æ‰§è¡Œ
- **é»˜è®¤ç«¯å£**: 22
- **é…ç½®æ–‡ä»¶**: `/etc/ssh/sshd_config`
- **æœåŠ¡ç®¡ç†**: `systemctl [start|stop|restart|status] sshd`

### é˜²ç«å¢™
Linuxç³»ç»Ÿå¸¸è§çš„é˜²ç«å¢™å·¥å…·:
1. **iptables**: åº•å±‚é˜²ç«å¢™å·¥å…·
2. **firewalld**: CentOS/RHELé»˜è®¤é˜²ç«å¢™ç®¡ç†å·¥å…·
3. **ufw**: Ubuntu/Debianç®€åŒ–çš„é˜²ç«å¢™ç®¡ç†å·¥å…·

### äº‘å®‰å…¨ç»„
- **å®šä¹‰**: è™šæ‹Ÿé˜²ç«å¢™ï¼Œæ§åˆ¶äº‘æœåŠ¡å™¨çš„å…¥ç«™å’Œå‡ºç«™æµé‡
- **ä¼˜å…ˆçº§**: é€šå¸¸ä¼˜å…ˆäºæœåŠ¡å™¨å†…éƒ¨é˜²ç«å¢™
- **é…ç½®**: åœ¨äº‘æœåŠ¡å•†æ§åˆ¶å°é…ç½®

### Dockeréƒ¨ç½²
é¡¹ç›®ä½¿ç”¨Dockerè¿›è¡Œå®¹å™¨åŒ–éƒ¨ç½²:
- **docker-compose**: å¤šå®¹å™¨åº”ç”¨ç¼–æ’å·¥å…·
- **å¥åº·æ£€æŸ¥**: ç¡®ä¿å®¹å™¨æ­£å¸¸è¿è¡Œ
- **æ—¥å¿—ç®¡ç†**: `docker-compose logs`æŸ¥çœ‹åº”ç”¨æ—¥å¿—

---

## ğŸ¯ é¢„æœŸç»“æœ (ä¿®å¤å)

ä¿®å¤SSHè¿æ¥åï¼Œéƒ¨ç½²æµç¨‹åº”è¯¥å¦‚ä¸‹:

```bash
# 1. SSHè¿æ¥æˆåŠŸ
ssh root@yushuo.click
# æç¤º: Welcome to ...

# 2. è¿›å…¥é¡¹ç›®ç›®å½•
cd /www/wwwroot/stock-tracker
# å½“å‰ç›®å½•: /www/wwwroot/stock-tracker

# 3. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main
# æç¤º: Already up to date. æˆ–æ˜¾ç¤ºæ›´æ–°çš„æ–‡ä»¶

# 4. æ‰§è¡Œéƒ¨ç½²
chmod +x deploy.sh && ./deploy.sh
# æ˜¾ç¤º: æ„å»ºé•œåƒ -> å¯åŠ¨å®¹å™¨ -> å¥åº·æ£€æŸ¥

# 5. éªŒè¯éƒ¨ç½²
docker-compose ps
# æ˜¾ç¤º:
# stock-tracker-app: Up (healthy)
# stock-tracker-mysql: Up (healthy)

# 6. è®¿é—®åº”ç”¨
# http://yushuo.click:3002 - æ˜¾ç¤ºStock Trackerç•Œé¢
```

---

## ğŸ“ æ”¯æŒä¿¡æ¯

- **æœåŠ¡å™¨**: yushuo.click (75.2.60.5)
- **é¡¹ç›®ä»“åº“**: https://github.com/yushuo1991/911.git
- **åº”ç”¨ç«¯å£**: 3002
- **æ•°æ®åº“**: MySQL (Dockerå®¹å™¨)

---

## âœ… æ£€æŸ¥æ¸…å•

- [x] ç½‘ç»œè¿é€šæ€§æµ‹è¯•
- [x] DNSè§£æéªŒè¯
- [x] SSHç«¯å£æ‰«æ
- [x] HTTPç«¯å£æµ‹è¯•
- [ ] äº‘å®‰å…¨ç»„é…ç½®æ£€æŸ¥
- [ ] SSHæœåŠ¡çŠ¶æ€ç¡®è®¤
- [ ] é˜²ç«å¢™è§„åˆ™å®¡æŸ¥
- [ ] éƒ¨ç½²è„šæœ¬æµ‹è¯•
- [ ] åº”ç”¨è®¿é—®éªŒè¯

---

**æŠ¥å‘Šç”Ÿæˆ**: 2025-09-30
**è¯Šæ–­å·¥å…·**: Windows 10 + PowerShell + SSH Client
**ä¸‹æ¬¡æ›´æ–°**: ä¿®å¤SSHè¿æ¥å