╔══════════════════════════════════════════════════════════════╗
║         🚀 v4.8.6 服务器部署（日期弹窗优化）                 ║
╚══════════════════════════════════════════════════════════════╝

改动说明: 放大日期弹窗的板块名称和溢价徽章，提升可读性

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🚀 方法一：使用Perl替换（推荐）

复制整段到服务器执行:

cd /www/wwwroot/stock-tracker && \
echo "🔄 [1/6] 备份当前版本..." && \
cp src/app/page.tsx src/app/page.tsx.backup-v4.8.5 && \
echo "✅ 已备份" && \
echo "" && \
echo "📝 [2/6] 应用v4.8.6修改..." && \
perl -i -pe 's/font-medium text-gray-900/font-semibold text-sm text-gray-900/g' src/app/page.tsx && \
perl -i -pe 's/px-2 py-0.5 rounded text-2xs \$\{/px-2 py-0.5 rounded text-xs ${/g' src/app/page.tsx && \
perl -i -pe 's/px-1.5 py-0.5 rounded text-2xs font-medium \$\{getPerformanceClass/px-2 py-1 rounded text-xs font-medium ${getPerformanceColorClass/g' src/app/page.tsx && \
perl -i -pe 's/px-2 py-0.5 rounded text-xs font-semibold \$\{getPerformanceClass\(sector.total5DayPremium/px-2.5 py-1 rounded text-sm font-semibold ${getPerformanceColorClass(sector.total5DayPremium/g' src/app/page.tsx && \
echo "✅ 代码修改完成" && \
echo "" && \
echo "📦 [3/6] 获取容器ID..." && \
CONTAINER_ID=$(docker ps | grep stock-tracker-app | awk '{print $1}') && \
echo "容器ID: $CONTAINER_ID" && \
echo "" && \
echo "📂 [4/6] 复制到容器..." && \
docker cp src/app/page.tsx $CONTAINER_ID:/app/src/app/page.tsx && \
echo "✅ 代码已复制" && \
echo "" && \
echo "🔄 [5/6] 重启容器..." && \
docker restart $CONTAINER_ID && \
echo "" && \
echo "⏳ [6/6] 等待15秒..." && \
sleep 15 && \
docker ps | grep stock-tracker && \
curl -I http://localhost:3002 && \
echo "" && \
echo "✅ v4.8.6部署完成！访问 http://bk.yushuo.click 验证"

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🚀 方法二：Git拉取后重新构建

cd /www/wwwroot/stock-tracker && \
git fetch origin && \
git checkout -- src/app/page.tsx && \
git pull origin main && \
docker compose down && \
docker compose build && \
docker compose up -d && \
sleep 20 && \
docker ps | grep stock-tracker && \
curl -I http://localhost:3002

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔍 验证v4.8.6部署成功

1. 访问 http://bk.yushuo.click
2. 按 Ctrl+Shift+R 强制刷新
3. 点击任意日期（如"09-22"）
4. 观察日期弹窗变化:

修改前 (v4.8.5):
- 板块名称: font-medium（12px）
- 个股数: text-2xs（10px）
- 溢价徽章: text-2xs px-1.5 py-0.5（10px）
- 总和徽章: text-xs px-2 py-0.5（12px）
- 使用getPerformanceClass（有样式冲突）

修改后 (v4.8.6):
- 板块名称: font-semibold text-sm（14px，更醒目）✨
- 个股数: text-xs（12px）✨
- 溢价徽章: text-xs px-2 py-1（12px，更大更清晰）✨
- 总和徽章: text-sm px-2.5 py-1（14px，更突出）✨
- 使用getPerformanceColorClass（避免冲突）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 v4.8.6 具体修改

文件: src/app/page.tsx (lines 845-869)

修改1: 板块名称（line 848）
<td className="px-2 py-1.5 font-medium text-gray-900">{sector.sectorName}</td>
                              ↓ 改为 ↓
<td className="px-2 py-1.5 font-semibold text-sm text-gray-900">{sector.sectorName}</td>

修改2: 个股数徽章（line 850）
<span className={`px-2 py-0.5 rounded text-2xs ${...`}>
                             ↓ 改为 ↓
<span className={`px-2 py-0.5 rounded text-xs ${...`}>

修改3: 溢价徽章（line 858）
<span className={`px-1.5 py-0.5 rounded text-2xs font-medium ${getPerformanceClass(avgPremium)}`}>
                             ↓ 改为 ↓
<span className={`px-2 py-1 rounded text-xs font-medium ${getPerformanceColorClass(avgPremium)}`}>

修改4: 总和徽章（line 864）
<span className={`px-2 py-0.5 rounded text-xs font-semibold ${getPerformanceClass(sector.total5DayPremium || 0)}`}>
                             ↓ 改为 ↓
<span className={`px-2.5 py-1 rounded text-sm font-semibold ${getPerformanceColorClass(sector.total5DayPremium || 0)}`}>

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔄 回滚到v4.8.5

如果部署后不满意:

cp /www/wwwroot/stock-tracker/src/app/page.tsx.backup-v4.8.5 \
   /www/wwwroot/stock-tracker/src/app/page.tsx
CONTAINER_ID=$(docker ps | grep stock-tracker-app | awk '{print $1}')
docker cp src/app/page.tsx $CONTAINER_ID:/app/src/app/page.tsx
docker restart $CONTAINER_ID

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📊 版本对比

| 元素 | v4.8.5 | v4.8.6 | 说明 |
|------|--------|--------|------|
| 板块名称 | 12px font-medium | 14px font-semibold | ↑ 更醒目 |
| 个股数 | 10px | 12px | ↑ 更清晰 |
| 溢价徽章 | 10px px-1.5 py-0.5 | 12px px-2 py-1 | ↑ 更大 |
| 总和徽章 | 12px px-2 py-0.5 | 14px px-2.5 py-1 | ↑ 更突出 |
| 颜色函数 | getPerformanceClass | getPerformanceColorClass | 避免冲突 |

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📝 Git提交记录

commit 47af58d (HEAD -> main, origin/main)
Author: Claude Code
Date: 2025-10-03

    feat: v4.8.6 放大日期弹窗板块名称和溢价徽章

    日期弹窗优化（点击日期显示板块后续5天溢价）:
    - 板块名称: font-medium → font-semibold text-sm（12px→14px，更醒目）
    - 个股数徽章: text-2xs → text-xs（10px→12px）
    - 溢价徽章: text-2xs px-1.5 py-0.5 → text-xs px-2 py-1（更大更清晰）
    - 总和徽章: text-xs px-2 py-0.5 → text-sm px-2.5 py-1（更突出）
    - 使用getPerformanceColorClass()避免样式冲突

    用户反馈: 板块名称和溢价色块有点小，需要更大更醒目

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

创建时间: 2025-10-03
版本: v4.8.6
改动文件: src/app/page.tsx (lines 845-869)
目的: 提升日期弹窗可读性，板块名称和溢价徽章更醒目
